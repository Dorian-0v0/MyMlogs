### geoserver放网关下

构建统一API入口，同时构造restful Api

负载均衡，之后集群部署的时候减轻各个节点的压力

安全：此外还要就是将springboot项目和geoserver同时放在docker里自定义的一个网络里，同时只暴露网关的端口，那么外部就不能直接访问geoserver，都必须经过网关，同时再给网关加一个解析JWTtoken的功能，就可以实现一个校验功能了。

### WMTS和wfs

wmts就是瓦片服务，相当于是一个瓦片金字塔，在顶端（比例尺小的时候给的是一个范围更大的瓦片，比例尺大的时候给的是一个范围更小的瓦片），同时瓦片还会缓存，这样的话加载底图geoserver就计算压力没wms大，因为wms是每次移动底图就相当于请求一次geoserver，传的参数是bbox，这样每一次拖动的都不一样，geoserver还会根据bbox来计算给前端返回哪张图片。

wfs相当于获取和编辑矢量数据，也可以在url里加CQL参数来实现具体的查询操作，可以指定返回geojson或GML格式的数据

### 空间索引

由于领取地点不会总改变，但大多时候就是查询用，而且查询条件里往往会使用PostGIS里的操作空间数据的函数，如果数据量大的时候查询就非常慢，所以通常就是加空间索引，一般是GIST索引。

同时使用redis存储查询得到的geojson格式的数据，保证之后可以直接使用缓存，如果修改数据库那么就要考虑缓存数据库的一致性，所以我就采用先操作数据库后通过AOP删除缓存的策略，这样可以解决大部分情况下的缓存一致性问题。

### JWT+Redis

就是保证退出系统或修改密码的时候token也同时失效，因为就算设置了token的过期时间，也不能保证退出系统token立即失效，所以就在redis里有一个键值对，键是token解析得到的用户id，而且这个键值对不设置过期时间，只有退出系统时才过期，退出系统如果再携带原来的token发现redis没有token解析的id组成的键值对在redis里面的话就请求失败。而token会有过期时间，如果过期发现redis那个键值对里还有数据，那么就刷新过期时间，

### 高德底图

leaflet加载高德底图，主要是要用高德API，但是高德API只能使用GCJ-02坐标系，leaflet比较轻量级而且地图交互功能比较强大，所以leaflet来添加丢失地点和拾取地点，同时添加点击事件调用逆地理编码得到位置信息，还有就算一个简单的路径规划，可以通过js代码来获取当前的地理位置，之后调用高德api来实现路径规划。

此外由于是使用Mapbox来开发可视化大屏，所以高德地图上的点最后要在mapbox上加载，当时mapbox上是wgs84坐标系，所以就通过java代码里使用GeoTools读取高德火星坐标的wkb编码并通过特定的算法来解析为wgs84坐标系的geojson格式的数据加载到mapbox上。

### OGC标准

统一规定里一些空间数据的格式，比如geojson、GML

规定了wfs，wms，wmts，wcs（加载栅格数据）接口和功能规范

